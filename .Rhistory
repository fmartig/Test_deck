apply(x1c,1,mean)
fit1<-lm(Fertility~Agriculture,swiss)
fit3<-lm(Fertility~Agriculture+Examination+Education,swiss)
anova(fit1,fit3)
deviance(fit3)
d<-deviance(fit3)/43
n<-(deviance(fit1)-deviance(fit3))/2
n/d
pf(n/d,2,43,lower.tail=FALSE)
shapiro.test(fit3$residuals)
anova(fit1,fit3,fit5,fit6)
View(ravenData)
mdl<-glm(ravenWinNum~ravenScore,family=binomial,data=ravenData)
lodds<-predict(mdl,data.frame(ravenScore=c(0,3,6)))
exp(lodds)/(1+exp(lodds))
summary(mdl)
exp(confint(mdl))
anova(mdl)
qchisq(0.95,1)
var(rpois(1000,50))
nxt()
head(hits)
class(hits$date)
as.integer(head(hits[,"date"]))
mdl<-glm(visits~date,family=poisson,data=hits)
summary(mdl)
exp(confintmdl,"date")
exp(confint(mdl,"date"))
which.max(hits[,'visits'])
hits[704,]
lambda<-mdl$fitted.values[704]
qpois(0.95,lambda)
mdl2<-glm(simplystats~data,offset=log(visits+1),family=poisson,data=hits)
mdl2<-glm(simplystats~date,offset=log(visits+1),family=poisson,data=hits)
qpois(0.95,mmdl2$fitted.values[704])
qpois(0.95,mdl2$fitted.values[704])
fileUrl="https://github.com/bcaffo/courses/blob/master/08_PracticalMachineLearning/lectures/001predictionMotivation.pdf"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/", method="curl")
fileUrl="https://github.com/bcaffo/courses/blob/master/08_PracticalMachineLearning/lectures/001predictionMotivation.pdf?raw=true"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/", method="curl")
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/001predictionMotivation.pdf", method="curl")
fileUrl="https://github.com/bcaffo/courses/blob/master/08_PracticalMachineLearning/lectures/001predictionMotivation.pdf"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/001predictionMotivation.pdf", method="curl")
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/001predictionMotivation.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_efd4870f2f839c5e86f470d05113ba07_003relativeImportance.pdf?Expires=1452124800&Signature=hPoVYNWmCOGUjHJmLKbauS0-NSBeNBbP0oyegErtfGJip69L0H82CZqJpiJsRYjRcRHbyHXwpy6Y7v~bTxIUg9Qn874lcG67sP~-Z8xQzh7NlIvyPLWl8Gvla5D~gR1rZsXf5315mLEfVV3k6qOFWl6512ZmyFsAaOIxCfFZCS0_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/003relativeImportance.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_43a1df45055979f3f50826ae1a1c4fba_004inOutSampleErrors.pdf?Expires=1452124800&Signature=AQMQN95e4lT9lVA8BpUeNgzSOiIqO2msOpRjMoCc8ishHHWf1Rb-J2VqmhlouJLzUJoVtdlkQ9tXmU1qi7TJIrxD~ctIYtpeNltIgvChWwmRhzbjL8vJHOZyPqp3TWHf~Td6AK0R9xFaOUMiiwYYCU7qVQvL5irbKN51XcNdRQA_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/004inOutSampleErrors.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_aa9a756c099325b879f383ae5392e31a_005predictionStudyDesign.pdf?Expires=1452124800&Signature=ap7z7hHF02ceuwjCpH5yhJEDjY-I-V8aU1yk80Gpd5SsugjHVBtr3NwqVT0l1f1DBiQqnVooP9x-Sf5o4sA~f9scQ7rhdax4IsTcu05X6xH2LsHb3IBgg5g6H-tJCeYHPx8lj3XCsOb2YT~cwDK7I9lkDHBXi5gX~Hd~vwCffXk_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/005predictionStudyDesign.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_994abda435d9ac4fc20c17c4787c24a0_006typesOfErrors.pdf?Expires=1452124800&Signature=a-RXqXvuq2uSghPBApNg9H~OY9gZRlpA5uK8jU6DIRzoByrA~qZYmAHiKl-R5hb5XOnz~zfj5lCPUSA-iYv6PCjbN5XoH2y1At7ZaGUN7nQIHx4WVNwsQ39hsCE93Mt7J7g7wev-m0a~4oOIGY0zm9ci91VRjag58XF1acsJDHE_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/006typesOfErrors.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_e3f677cc0b65f87802e675cac409e6f4_008crossValidation.pdf?Expires=1452124800&Signature=RiZhxlUuxbhzHdY732Qn4eQjHlbs0w2spDY2i2V29MgEYVRChzdre6MwNIpUPUgvZXm2B3XTOEgqwt-bH2HjNHCEp3zPpwA1sC~gkmQxheO-OVaIdHer2CIPrEfhwx~qGxzpuYyjo8YmmpdEGQWH539VOsjIPV-yrnqEm8t2F9k_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/008crossValidation.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_5fe059c278f0f156c88da1994dac947d_009whatData.pdf?Expires=1452124800&Signature=S9HPpbbvR1qvdiHIXKM0GkWI5xy4EAUXAIR~mZzT7zj1Db4f8tU3RxzTf6bbLajKyDr8oyz1gDkRvwutENctCezsx0wEtwZJPfSdn9ECrw71v42oHgKDvuFIhKa19ODVaDPOE98NJXW0CtSOARej00CH--usTA5l7k7INfnHFy8_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/009whatData.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_f0c782a94e50535bec6284d36d134808_010caretPackage.pdf?Expires=1452470400&Signature=GXscNsp2PWkrmBSzeA6Ln6gPEiemqH7cT5l9dQlaUoPmSOLMkneYoCtI-9y6lMPBjjivsnpX1bWi96S8SSrMp-ZkQCHriDxS1ikm~g02xP2wFQXNToatUbHkAdIRgv7jRm6zyA2LZwNkfiq-zkdYdNWJsjhfX3zsYyaf8Vm3kWU_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/010caretPackage.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_23fdf718f10c97a6c1093f7dda2681e4_011dataSlicing.pdf?Expires=1452470400&Signature=BhdjIu8oKkMrcDPLplsFI~3RqC0MCSYMFUFKOL6z6~CDJuA-obOtc50ni7urNoxFcAMBotb~tYTN6ZNUxTfyt2fXJoipQMKxdOc~j0ekkIR9yUJBbzCZVaaZ8qK4D9CbCZYLNcl6m1UCgosnLaNYIsddIiTw0ZYUcVmrTryhNHo_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/011dataSlicing.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_c9b82c2b248ca185159a34dad5f8d41c_012trainOptions.pdf?Expires=1452470400&Signature=UA3sGardn~iM~hBlkeD7mJYimK1vBqVsJFKkz29Bv4X1yO5AB~6-HVQKJRAFvC8bDEMC22YRhPS936Otg69rZtew0Ofww-rKhVk2DofZY~mZLRCVAj6RHlmMLqAcB68FvMoOrOpK6xq4e-6ppUW-mAXxNTPfg1FOzBSUkOeTDb0_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/012trainOptions.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_92520c522b1329e6e305616bb561eac3_013plottingPredictors.pdf?Expires=1452470400&Signature=eEjj08uUmpVGcqDwpcND4E9deevg-R3P6hrvAN0G9-XshwuVWFI81J-NMwhN8zzg0NyHNmY4xemaYpjIp2rY0SLLapXb2XIxd5VQOb1-STtypwQJjSkuA0MrFDcV5sX~ly377RQz60zU13580QwCFZ5dlInMn09eMh~GSpE9lYs_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/013plottingPredictors.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_df220085db75d23ab601f6afed1b12b2_014basicPreprocessing.pdf?Expires=1452470400&Signature=icL~pcGaTLq73fd3Xoh5ni5pwq5eULvGxg1NkZ-s0G~2~GEKyvi6r9vidggOrZHuCZzUTZfjdJdPbEV4n2a0KhyWUAHwCGIekH6wkxY7jQqM8DNOeQTI~FWGVEpB29vAs~fLkxXiTqWxrUpe4kjbi33OYvPgT-mkPOI99qDzpk4_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/014basicPreprocessing.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_200d6e238deee2f41137ecf2d5c2a373_015covariateCreation.pdf?Expires=1452470400&Signature=avCTf5510Z3svkcyfIeS0iAJNUsVWVxJFOZNW~sgXeQGXlGZhhlH6bb2mNoteDkJ-ZKMPGfrNMZBEcl0NzIKKZ~m4NdXYK1GVJalNCLxkUSIqTPRlZozbPq0WgV2PRpThATS2zVTr2B3WZ8ZmXDruKkP6bBrEpjCrCN0BM~tf4s_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/015covariateCreation.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_2d60f2ec7ce758223d0d02cccde1a25d_016preProcessingPCA.pdf?Expires=1452470400&Signature=BFvVfG6qjxZZJ~LKNe1o~-n7Y39t8iVkee6wLfpazKnv206eZPXMlSjxAzwqo2PU-WhyQ7cFvUdRefW9mTnzizX62rVHRkNoA34mYs6CPeuBu77z3GIA~pRFMGLVppfjQzBzjG0SK5tdiO5UjCbIOTTEqNGZyxrQnlku-vRR88Q_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/016preProcessingPCA.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_b9bf4fbd3421efea855090d221db10cc_017predictingWithRegression.pdf?Expires=1452470400&Signature=ckR-0ifwKZh-LWrlbAwGvqTZysJrKXROxmecvYT6O3YdWLJjbwNtif5bvf4ldpKbn~KSuAIDdsHhjnDpkU7ixboBrW5eS0dron6umoXPwXjOy~b5QB58WKTsPWPvzySUGFs3UzQO5B2tprGrI0wRP2vPgnO2zAsp-UZTs7Ceeno_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/017predictingWithRegression.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_05fad59a69ab9ef69ef8eca2ed070136_018predictingWithRegressionMC.pdf?Expires=1452470400&Signature=aOJmtFVF8ZDGEHie2uae3sg9xq2B4Vx4NiUszvX7L6QrhZBBqAyyRokoM5QzjbeFwUE5-DbfkHRGBzKgt6tkd77IXogHcjch97l9USPFDHe7pEKgygUClniri5dSeLejiNbcClpXXN4E6fB~uSUIoQxjBFRwFPenv0Ew~5QjIvU_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/018predictingWithRegressionMC.pdf", method="curl")
install.packages("caret")
library(caret)
library(datasets)
airquality<-data.frame(airquality)
partial<-airquality[,-Day]
partial<-airquality[,-airquality$Day]
names(partial)
head(partial)
partial<-airquality[,c(Ozone,Wind,Temp)]
head(partial)
partial<-airquality[,c("Ozone","Wind","Temp")]
head(partial)
partial2<-airquality[,-"Day"]
partial2<-airquality[,-3]
head(partial2)
names(partial2)
subset(airquality,select=-c(June))
subset(airquality,select=-c(month))
names(airquality)
subset(airquality,select=-c(Day))
names(subset(airquality,select=-c(Day)))
library(AppliedPredictiveModeling)
install.packages("AppliedPredictiveModeling")
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
View(concrete)
set.seed(1000)
inTrain=createDataPartition(mixture$CompressiveStrength,p=3/4)[[1]]
inTrain=createDataPartition(mixtures$CompressiveStrength,p=3/4)[[1]]
training=mixtures[inTrain,]
testing=mixtures[-inTrain,]
View(training)
plot(training$CompressiveStrength,pch=19)
library(Hmisc)
names(training)
cutCement<-cut2(training$Cement,g=4)
cutCement
plot(training$CompressiveStrength,pch=19,color=cutCement)
qplot(CompressiveStrength,data=training)
qplot(CompressiveStrength,data=training,geom="points")
qplot(CompressiveStrength,data=training,geom="point")
qplot(row.names,CompressiveStrength,data=training,geom="point")
ggplot(training,aes(x=seq(1,length(training$CompressiveStrength)),y=CompressiveStrength))+geom_point()
x=seq(1,length(training$CompressiveStrength))
qplot(x,CompressiveStrength,data=training)
qplot(x,CompressiveStrength,data=training,fill=cutCement)
qplot(x,CompressiveStrength,data=training,color=cutCement)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength),colour=cutCement)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutCement))
cutCement<-cut2(training$Cement,g=2)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutCement))
cutFlyAsh<-cut2(training$FlyAsh,g=3)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
cutAge<-cut2(training$Age,g=4)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutAge))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutCement))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
cutFlyAsh<-cut2(training$FlyAsh,g=4)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
cutFlyAsh<-cut2(training$FlyAsh,g=4)
levels(cutFlyAsh)
cutFlyAsh<-cut2(training$FlyAsh,g=3)
levels(cutFlyAsh)
cutFlyAsh<-cut2(training$FlyAsh,g=2)
levels(cutFlyAsh)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
names(training)
cutBFS<-cut2(training$BlastFurnaceSlag,g=4)
cutWater<-cut2(training$Water,g=4)
cutSuper<-cut2(training$Superplasticizer,g=4)
cutCA<-cut2(training$CoarseAggregate,g=4)
cutFA<-cut2(training$FineAggregate,g=4)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutBFS))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutWater))
cutWater<-cut2(training$Water,g=3)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutWater))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutSuper))
cutSuper<-cut2(training$Superplasticizer,g=2)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutSuper))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutCA))
cutCA<-cut2(training$CoarseAggregate,g=3)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutCA))
cutFA<-cut2(training$FineAggregate,g=3)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFA))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutAge))
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
qplot(x,CompressiveStrength,data=training)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutAge))
cutAge<-cut2(training$Age,g=3)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutAge))
cutAge<-cut2(training$Age,g=4)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutAge))
cutFlyAsh<-cut2(training$FlyAsh,g=4)
ggplot(training)+geom_point(aes(x=x,y=CompressiveStrength,colour=cutFlyAsh))
set.seed(1000)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
qplot(SuperPlasticizer,data=training)
qplot(Superplasticizer,data=training)
ln<-log(training$Superplasticizer+1)
qplot(ln)
qplot(Superplasticizer,data=training)
qplot(ln)
qplot(Superplasticizer,data=training)
library(kernlab)
install.packages("kernlab")
library(kernlab)
data(spam)
inTrain<-createDataPartition(y=spam$type,p=0.75,list=FALSE)
training<-spam[inTrain,]
testing<-spam[-inTrain,]
library(AppliedPredictiveModeling)
set.seed(3433)data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]training = adData[ inTrain,]
testing = adData[-inTrain,]
data(AlzheimerDisease)
set.seed(3433)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
names(training)
subt<-training$IL
subt<-names(training)$IL
subt<-names(training)[["IL",exact=FALSE]]
subt<-training[,58:69]
names(subt)
?grepl
il<-grepl("IL*",names(training))
sub<-training[,il]
View(sub)
il<-grepl("^IL*",names(training))
sub<-training[,il]
View(sub)
il<-grepl("^IL",names(training))
sub<-training[,il]
View(sub)
sub<-training[,il]
View(sub)
names(sub)
prComp<-prcomp(sub)
prComp$rotation
n<-nrow(sub)
n
View(sub)
totvar<-apply(sub,2,var)
totvar
sum(totvar)
vardata<-sum(totvar)
test<-sum(prComp$rotation[,1]*sub)
pc1<-1/n*sum(sum(prComp$rotation[,1]*sub)^2)
pc1/vardata
var(sub)
test<-diag(var(sub))
test
var(prComp$rotation[,1])
var(prComp$rotation[,1])/sum(test)
var(prComp$rotation[,2])
sum(var(prComp$rotation[,1],var(prComp$rotation[,2]),var(prComp$rotation[,3]),var(prComp$rotation[,4]),var(prComp$rotation[,5]),var(prComp$rotation[,6],var(prComp$rotation[,7]),var(prComp$rotation[,8]),var(prComp$rotation[,9]),var(prComp$rotation[,10]),var(prComp$rotation[,11]),var(prComp$rotation[,12]))
)
)
sum(var(prComp$rotation[,1],var(prComp$rotation[,2]))
)
?sum
varpc<-apply(prComp$rotation,2,var)
varpc
sum(varpc)
totvar<-sum(apply(sub,2,var))
totvar
var(prComp$rotation[,1])
?cov
cov(prComp$rotation)
diag(cov(prComp$rotation))
diag(cov(sub))
covMat<-cov(prComp$rotation)
eigen(covMat,symmetric=TRUE)
eigenval<-eigen(covMat,symmetric=TRUE)$values
eigenval
sum(eigenval)
prComp$rotation
test<-sum(sum(sub)^2)
subsqu<-sub^2
subsqu<-as.matrix(sub^2)
subsqu
step1<-apply(subsqu,1,sum)
step2<-sum(step1)
step2/n
prComp<-prcomp(sub,center=TRUE,scale.=TRUE)
prComp$rotation
varpc<-apply(prComp$rotation,2,var)  #variance of each principal component NOT RIGHT ?
varpc
sum(varpc)
prComp<-prcomp(sub,center=TRUE,scale.=TRUE)
plot(prComp,type="l")
summary(prComp)
log_sub<-log(sub)
log_sub<-log(sub+1)
?preProcess
trans<-preProcess(sub,method=c("BoxCox","center","scale","pca"))
trans<-preProcess(sub,method=c("BoxCox","center","scale","pca"),thresh=0.80)
PC<-predict(trans,sub)
head(PC,3)
transfull<-preProcess(sub,method=c("BoxCox","center","scale","pca"))
PCfull<-predict(transfull,sub)
head(PCfull,3)
prComp<-prcomp(sub,center=TRUE,scale.=TRUE)
summary(prComp)
library(caret)
library(AppliedPredictiveModeling)
set.seed(3433)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
inTrain = createDataPartition(adData$diagnosis, p = 3/4)[[1]]
training = adData[ inTrain,]
testing = adData[-inTrain,]
il<-grepl("^IL",names(training))
View(testing)
sub<-training[,il]
trainsub<-cbind(diagnosis,sub)
sub<-training[,il]
trainsub<-cbind(training$diagnosis,sub)
View(trainsub)
View(training)
mod1<-train(diagnosis~.,data=trainsub,method="glm")
mod1<-train(trainsub$diagnosis~.,data=trainsub,method="glm")
head(trainsub)
trainsub$diagnosis<-as.factor(trainsub$diagnosis)
trainsub<-cbind(training[,1],sub)
head(trainsub)
trainsub$diagnosis<-trainsub$training[,1]
names(trainsub)<-c("diagnosis","11","13","16","17E","1alpha","3","4","5","6","Receptor","7","8")
head(trainsub)
mod1<-train(diagnosis~.,data=trainsub,method="glm")
summary(mod1)
mod1
mod1<-train(diagnosis~.,data=trainsub,preProcess=c("center","scale"),method="glm")
mod1
preproc<-preProcess(trainsub[,-1],method="pca",pcaComp=7)
trainPC<-predict(preproc,trainsub[,-1])
mod2<-train(trainsub$diagnosis~.,method="glm",data=trainPC)
il<-grepl("^IL",names(testing))
sub2<-testing[,il]
testsub<-cbind(testing[,1],sub2)
names(testsub)<-c("diagnosis","11","13","16","17E","1alpha","3","4","5","6","Receptor","7","8")
testPC2<-predict(preproc,testsub[,-1])
confusionMatrix(testsub$diagnosis~.,predict(Mod2,testPC2))
confusionMatrix(testsub$diagnosis,predict(Mod2,testPC2))
confusionMatrix(testsub$diagnosis,predict(mod2,testPC2))
confusionMatrix(testsub$diagnosis,predict(mod1,testsub))
il<-grepl("^IL",names(training))
sub<-training[,il]
trans<-preProcess(sub,method=c("BoxCox","center","scale","pca"),thresh=0.80)
trans<-preProcess(sub,method=c("BoxCox","center","scale","pca"),thresh=0.90)
PC<-predict(trans,sub)
head(PC,3)
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_4128d258838072915c2c1e039b4aac4d_019predictingWithTrees.pdf?Expires=1452816000&Signature=bgBULwKGWscZtBKyVIlHSiwdQoYAZOHgFC5rV-mqYC0130naPvDeaaKDA4uihhdPbXKGojmvIKXy1Hbc4Wa6gWVYn~Oi-U2mecUMLDmUNyvDAjQ1mqn1o6CdNH~-PLbRdHjE~hXR3Z1gMsYV6TCpOtuGz8S5rHsnK1nANlFEHqg_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/019predictingWithTrees.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_4af56cc83ecb526844445a787a746190_020bagging.pdf?Expires=1452816000&Signature=axPHr5cLgIYEb3a-BoU9f5JLv-ESm8zD7s2dflR8FXS~Ut1ygVqB5vOQhyTwBaLbFj2c6~u17Fb7MsOtEn-4120mh6CVfQrvGTD6oh4aw7iU6JAtaqHzWxNRe5EvPVH5C50jleSPw5HcB4s1KK3wdEiVdzsFcLukAGnBzlaaItU_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/020bagging.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_22b8678c43954c48daa5bb151a6a9a0f_021randomForests.pdf?Expires=1452816000&Signature=NCTZFB07AdIIjfwViL0y1O39~LE4kyNTjNMquzQBq-GZ8Jyvsv7u4DAja3~0SW8Ut17GQgBtPwcovVmz1MPkKp-3WzXjmB4cinI46nC0ZIWOfmrduXF8UakzGjQyZKFBEfb2qi27jkRpkWZtAmuy9dfsBd0FQiVm87q5PBKjuBg_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/021randomForests.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_15e2455eecc909c8a65d99aa3b50d53b_022boosting.pdf?Expires=1452816000&Signature=buD5TAfaVGQNu4SkLyyOtMQMIyuBr0q2Wm42ZN9qbhxUn9iEy~BJSDRdDK55gaxTa2Znr8kH0eBzI2nf~ZGLh~hG2A3fI-k~hiJhT-r1K~r2XSzJxj2e0mjiXESFHu0-ZExSKOq3mDawR9X2LQlqmmzz8l8M-T5b76NEhCK2CjU_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/022boosting.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_82cafd5da7820222defb1f171729cf45_023modelBasedPrediction.pdf?Expires=1452816000&Signature=Tjbd4M-fkE57Wv6FjXITki61iYuvGk2dlW5plgpC4lnkWZ1xMmFwC-Ti4Ubo4V8gtly2jwo1BaRAqKm6Jtdzfo-kyFHeHdEMlxOtqklUOIaxVEDdY8jJYks6dX3IihLuQsKhBfSTKGGzYED~Cebu5GyGfCQTXAo88HSak5nAEIQ_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/023modelBasedPrediction.pdf", method="curl")
library(AppliedPredictiveModeling)
data(segmentationOriginal)
library(caret)
names(segmentationOriginal)
inTrain<-createDataPartition(y=segmentationOriginal$Case,p=0.7,list=FALSE)
training<-segmentationOriginal[inTrain,]
testing<-segmentationOriginal[-inTrain,]
dim(training)
dim(testing)
set.seed(125)
unique(segmentationOriginal$Case)
View(segmentationOriginal)
unique(segmentationOriginal$Class)
test1<-subset(testing,TotalIntench2 == 23000 & FiberWidthCh1==10 & PerimStatusCh1=2)
test1<-testing[testing$TotalIntench2==23000 & testing$FiberWidthCh1==10 & testing$PerimStatusCh1=2,]
test1<-testing[testing$TotalIntench2==23000 & testing$FiberWidthCh1==10 & testing$PerimStatusCh1==2,]
test1<-testing[testing$TotalIntench2==23000,]
View(testing)
test1<-testing[testing$PerimStatusCh1==2,]
View(test1)
library(AppliedPredictiveModeling)
data(segmentationOriginal)
library(caret)
View(segmentationOriginal)
training<-segmentationOriginal[segmentationOriginal$Case=="Train",]
testing<-segmentationOriginal[segmentationOriginal$Case=="Test",]
test1<-testing[testing$TotalIntench2==23000,]
install.packages("pgmm")
library(pgmm)
data(olive)
olive = olive[,-1]
View(olive)
library(ElemStatLearn)
install.pckages("ElemStatLearn")
install.packages("ElemStatLearn")
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel.train$y<-as.factor(vowel.train$y)
View(vowel.train)
vowel.test<-as.data.frame(vowel.test)
vowel.test$y<-as.factor(vowel.test$y)
mod3<-train(Area~.,method="rpart",data=olive)
newdata = as.data.frame(t(colMeans(olive)))
mod3<-tree(Area~.,data=olive)
library(tree)
install.packages("tree")
mod3<-tree(Area~.,data=olive)
library(tree)
mod3<-tree(Area~.,data=olive)
newdata = as.data.frame(t(colMeans(olive)))
predict(mod3,newdata)
print(modFit$finalModel)
training<-segmentationOriginal[segmentationOriginal$Case=="Train",]
testing<-segmentationOriginal[segmentationOriginal$Case=="Test",]
set.seed(125)
modFit<-train(Class~.,method="rpart",data=training)
print(modFit$finalModel)
plot(modFit$finalModel, uniform=TRUE)
plot(modFit$finalModel, uniform=TRUE,main="Classification tree")
text(modFit$finalModel,use.n=TRUE,all=TRUE,cex=0.8)
install.packages("rattle")
library(rattle)
fancyRpartPlot(modFit$finalModel)
print(modFit$finalModel)
? varImp
mod5<-train(y~.,data=vowel.train,method="rf",prox=TRUE)
mod5<-train(y~.,data=vowel.train,method="rf",prox=TRUE)
imp<-varImp(mod5)
imp
library(ElemStatLearn)
data(vowel.train)
data(vowel.test)
vowel<-rbind(vowel.train,vowel.test)
View(vowel)
vowel$y<-as.factor(vowel$y)
set.seed(33833)
mod5<-train(y~.,data=vowel,method="rf",prox=TRUE)
imp<-varImp(mod5)
imp
vowel.train$y<-as.factor(vowel.train$y)
vowel.test$y<-as.factor(vowel.test$y)
mod5<-train(y~.,data=vowel.train,method="rf",prox=TRUE)
imp<-varImp(mod5)
imp
set.seed(33833)
mod6<-train(y~.,data=vowel.test,method="rf",prox=TRUE)
imp<-varImp(mod6)
imp
library(ElemStatLearn)
data(SAheart)
set.seed(8484)
train = sample(1:dim(SAheart)[1],size=dim(SAheart)[1]/2,replace=F)
trainSA = SAheart[train,]
testSA = SAheart[-train,]
View(trainSA)
set.seed(13234)
mod4<-train(chd~age+alcohol+obesity+tobacco+typea+ldl,data=trainSA,method="glm",family="binomial")
missClass = function(values,prediction){sum(((prediction > 0.5)*1) != values)/length(values)}
missClass(trainSA$chd,predict(mod4))
missClass(testSA$chd,predict(mod4,newdata=testSA))
glm4<-glm(chd~age+alcohol+obesity+tobacco+typea+ldl,data=trainSA,family="binomial")
missClass(trainSA$chd,predict(glm4))
missClass(testSA$chd,predict(glm4,newdata=testSA))
missClass(trainSA$chd,mod4$fitted)
missClass(trainSA$chd,glm4$fitted)
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_64272eb0e91bb682508ad10123a7b767_024regularizedRegression.pdf?Expires=1453161600&Signature=Oke4yEEIccNppSl6WNr40Fv37p4uupz2le~np3U517ig3Gn25oFJCoxr2QJs9XnaqZ5Iri~xQUwKwsrwI0deJle09YPLc2cyf9cOPrn4hV12sYyX~1QRWb9reAbpbcKWETykOLGWICOl8gDvBriD5ycLZhipy6Vat3zOUq8BWtY_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/024regularizedRegression.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_7dc5d903db1fd6ed5c11cc4cc386a072_025combiningPredictors.pdf?Expires=1453161600&Signature=Ss627cMvSlzMl77SXYhRi35i25YIiETlg7RVfFZOMtvBPYweCsMlEbSfZw4OEXNtUQ6tPnAJXedlUY3Cy1XZohNAu08EDhR1PpXynltul~LSGG8Cbs3IlUpegWvc8uGW9SI0c7n7d1TlIjsjy4KbABQvqr6beEyD1YtJqTIGEBY_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/025combiningPredictors.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_b0b09d7bf4a299f0221d5af9c2594b15_027forecasting.pdf?Expires=1453161600&Signature=PNJ-T6jqSYuYIxf9D-6rLktJ~FmcFpJhEQDACIvZqD6qK4ynOwT0RFmVB9dV2Kqq7M6YB~gwZ8e4dvqIPVtya4LemDm1OqY40gSdjmNncujkE~hIChp1pVH3asn6EwHTsXYFBVl~h-3MsDQiZnjPeB0O16ayMt-jSB9CC7DPCpE_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/027forecasting.pdf.pdf", method="curl")
fileUrl="https://d3c33hcgiwev3.cloudfront.net/_1cbfe1d8381500954229b22477bf09c4_026unsupervisedPrediction.pdf?Expires=1453161600&Signature=FI31aonk2sFar89rabIXkJuiWxzxf6PEWzq33sC3a~Oe52SVvHhg-raG726C50E0OaZYc7yRfiu7UaoxImpOk5Tt4bL-Y4CcCR8LQBaMUvodIGTGR7DrF-cOVyxhphlg5CL9mj2bmyJuaKkgBinFwWrkPXTpwinfLWMh-Jx~GBk_&Key-Pair-Id=APKAJLTNE6QMUY6HBC5A"
download.file(fileUrl, destfile="~/Documents/Data_science/08_MachLearning/Lectures/026unsupervisedPrediction.pdf", method="curl")
library(devtools)
install_github('rCharts', 'ramnathv')
require(rCharts)
haireye = as.data.frame(HairEyeColor)## Generate the plotn1 = nPlot(Freq ~ Hair, group = 'Eye', type = 'multiBarChart',           data = subset(haireye, Sex == 'Male'))## Display the plotn1
haireye = as.data.frame(HairEyeColor)
n1 = nPlot(Freq ~ Hair, group = 'Eye', type = 'multiBarChart',           data = subset(haireye, Sex == 'Male'))
n1 = nPlot(Freq ~ Hair, group = 'Eye', type = 'multiBarChart', data = subset(haireye, Sex == 'Male'))
n1
data(economics, package = "ggplot2")
econ = transform(economics, date = as.character(date))
m1 = mPlot(x = "date", y = c("psavert", "uempmed"), type = "Line", data = econ)
m1$set(pointSize = 0, lineWidth = 1)
m1
install.packages("googleVis")
library(googleVis)
M = gvisMotionChart(Fruits, "Fruit", "Year", options = list(width = 600, height = 400))
plot(M)
stateDF = data.frame(State = state.name, state.x77)
gchart = gvisGeoChart(data = stateDF,                      plot(gchart)
gchart = gvisGeoChart(data = stateDF,plot(gchart))
gchart = gvisGeoChart(data = stateDF)
plot(gchart)
gchart = gvisGeoChart(data = stateDF,                      plot(gchart)                      locationvar = "State",                      colorvar = "Population",                      options = list(region="US",                                     displayMode="regions",                                     resolution="provinces",                                     width=600, height=400))
gchart = gvisGeoChart(data = stateDF,                      locationvar = "State",                      colorvar = "Population",                      options = list(region="US",                                     displayMode="regions",                                     resolution="provinces",                                     width=600, height=400))
gchart = gvisGeoChart(data = stateDF,locationvar = "State",colorvar = "Population",options = list(region="US",displayMode="regions",resolution="provinces",width=600, height=400))
plot(gchart)
head(stateDF)
install.package("leaflet")
install.packages("leaflet")
install.packages("leafletR")
library(leafletR)
m = leaflet() %>%    addTiles() %>%    addMarkers(lat=39.298113, lng=-76.590248, popup="Where Brian works")
m = leaflet() %>%        addTiles() %>%        addMarkers(lat=39.298113, lng=-76.590248, popup="Where Brian works")
install.packages("leaflet")
m = leaflet() %>%        addTiles() %>%        addMarkers(lat=39.298113, lng=-76.590248, popup="Where Brian works")
library(leaflet)
require(leaflet)
library(leaflet)
install.packages("leaflet")
M = gvisMotionChart(Fruits, "Fruit", "Year", options = list(width = 600, height = 400))
print(M,"chart")
library(rCharts)
library(datasets)
?dTable
data(airquality)
dTable(airquality,sPaginationType="full_numbers")
setwd("~/Documents//Data_science/09_DataProducts//Exercises")
library(slidify)
author("Test_deck")
slidify("index.Rmd")
publish(user = "fmartig", repo = "Test_deck", host = 'github')
slidify("index.Rmd")
slidify("index.Rmd")
publish(user = "fmartig", repo = "Test_deck", host = 'github')
